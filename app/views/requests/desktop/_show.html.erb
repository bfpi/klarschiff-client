<div id="show-request" class="request-container">
  <% label_photo_required = mark_photo_required(@request) -%>
  <%= render partial: '/requests/desktop/request_header', locals: { label_photo_required: label_photo_required } %>
  <div class="request-desktop">
    <% if @request.description.present? -%>
      <div class="row form-group">
        <%= label_tag :description, Request.human_attribute_name(:description), class: 'col-md-12 control-label' %>
        <div class="col-md-12"><em><%= @request.description %></em></div>
      </div>
    <% end -%>
    <% if display?(:votes) -%>
      <div id="request-show" class="row form-group <%="#{ @request.service.type }" %>">
        <%= label_tag :votes, Request.human_attribute_name(:votes), class: 'col-md-12 control-label' %>
        <div class="col-md-12">
          <%= t(".votes#{ '_under_min_req' if @request.idea? && @request.under_req? }_html", votes: @request.votes) %>
          <%= t('.votes_min_req', min_req: @request.min_req) if @request.idea? %>
          <span class="glyphicon glyphicon-question-sign" rel="tooltip" title="Dies dient nur als Indikator, ähnlich einer Umfrage. Die Prüfung auf Realisierbarkeit ist davon unabhängig und auch bei 20 Zustimmungen nicht garantiert!"></span></p>
        </div>
      </div>
    <% end -%>
    <% if (url = @request.media_url).present? -%>
      <div class="row form-group">
        <div class="col-md-12">
          <%= label_tag :media_url, Request.human_attribute_name(:media_url), class: 'control-label' %>
          <% if label_photo_required -%>
            <small><%= t('.hint_photo_required') %></small>
          <% end -%>
        </div>
        <div class="col-md-12">
          <img src="<%= url %>" alt="<%= Request.human_attribute_name(:media_url) %>" class="img-rounded img-responsive" />
        </div>
      </div>
    <% end -%>
    <div class="row form-group">
      <%= label_tag :status, Request.human_attribute_name(:status), class: 'col-md-12 control-label' %>
      <div class="col-md-12"><%= status(@request) %></div>
    </div>
    <% if (notes = @request.status_notes).present? -%>
      <div class="row form-group">
        <%= label_tag :status_notes, Request.human_attribute_name(:status_notes), class: 'col-md-12 control-label' %>
        <div class="col-md-12"><em><%= notes %></em></div>
      </div>
    <% end -%>
    <% options = { remote: true, class: 'btn btn-primary btn-block', role: :button } -%>
    <div class="row form-group">
      <% if display?(:votes) -%>
        <div class="col-md-12">
          <%= link_to(t('.actions.vote'), [:new, @request, :vote, id_list: @id_list], options) if display?(:votes) %>
        </div>
      <% end -%>
      <% if display?(:abuses) -%>
          <div class="col-md-12">
            <%= link_to(t('.actions.abuse'), [:new, @request, :abuse, id_list: @id_list], options) if display?(:abuses) %>
          </div>
      <% end -%>
      <div class="col-md-12">
        <%= link_to(t('.actions.comment'), [:new, @request, :comment, id_list: @id_list],
                    options.merge(class: 'btn btn-primary btn-block')) if display?(:create_comment) %>
      </div>
    </div>
    <% if @id_list.try(:include?, @request.id) && @id_list.count > 1 -%>
    <div class="col-md-12">
      <div class="btn-group btn-group-justified" role="group">
        <% if @id_list.first == @request.id -%>
          <%= link_to(content_tag(:span, '', class: 'glyphicon glyphicon-backward'), '#', class: 'btn btn-default disabled') %>
        <% else -%>
          <%= link_to(content_tag(:span, '', class: 'glyphicon glyphicon-backward'),
                      request_path(@id_list[@id_list.index(@request.id) - 1], id_list: @id_list, mobile: @mobile),
                      remote: true, class: 'btn btn-default backward') %>
        <% end -%>
        <% if @id_list.last == @request.id -%>
          <%= link_to(content_tag(:span, '', class: 'glyphicon glyphicon-forward'), '#', class: 'btn btn-default disabled') %>
        <% else -%>
          <%= link_to(content_tag(:span, '', class: 'glyphicon glyphicon-forward'),
                      request_path(@id_list[@id_list.index(@request.id) + 1], id_list: @id_list, mobile: @mobile),
                      remote: true, class: 'btn btn-default forward') %>
        <% end -%>
      </div>
    </div>
  <% end -%>
  </div>
</div>
